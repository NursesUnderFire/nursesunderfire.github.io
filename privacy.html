<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Privacy Policy - Nurses Under Fire</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; padding: 0; background: #f8f9fb; color: #1f2933; }
        header { background: #1f2933; color: white; padding: 1.5rem; }
        header a { color: #f06292; text-decoration: none; font-weight: 700; }
        main { max-width: 900px; margin: 0 auto; padding: 2rem 1.25rem 3rem 1.25rem; }
        h1 { margin-bottom: 0.5rem; }
        h2 { margin-top: 2rem; color: #d32f2f; }
        p { line-height: 1.6; }
        ul { line-height: 1.6; }
        .card { background: white; padding: 1.25rem; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); margin-top: 1rem; }
        footer { background: #1f2933; color: white; text-align: center; padding: 1.5rem 1rem; }
        footer a { color: #f06292; text-decoration: none; }
    </style>
</head>
<body>
    <header>
        <div style="display:flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 0.5rem;">
            <div><a href="index.html">Nurses Under Fire</a> / Privacy Policy</div>
            <div style="display:flex; gap:1rem;">
                <a href="contact.html">Contact</a>
                <a href="sitemap.html">Sitemap</a>
                <a href="accessibility.html">Accessibility</a>
            </div>
        </div>
    </header>
    <main>
        <h1>Privacy Policy</h1>
        <p>We only collect the information you choose to share so we can deliver your messages to representatives, share verified testimony, and keep you updated on violence-prevention advocacy. We do not sell or rent your data.</p>

        <div class="card">
            <h2>Information we collect</h2>
            <ul>
                <li>Contact form details: name, email, optional phone, ZIP code, and your message.</li>
                <li>Testimony submissions: stories you share via the testimony form, plus your preferred contact method.</li>
                <li>Technical data: basic logs needed to keep the site secure (IP address, timestamps, and user agent).</li>
            </ul>
        </div>

        <div class="card">
            <h2>How we use your information</h2>
            <ul>
                <li>To forward your advocacy messages to the appropriate representatives.</li>
                <li>To follow up with you about testimony you choose to share.</li>
                <li>To improve site reliability and safeguard against abuse.</li>
            </ul>
        </div>

        <div class="card">
            <h2>Testimonials and stories</h2>
            <p>Testimonials are only published with the storyteller’s explicit consent. Identifying details can be removed on request. If you want an existing testimonial hidden or updated, email <a href="mailto:nursesunderfire1@gmail.com">nursesunderfire1@gmail.com</a> with the subject line “Testimonial update.”</p>
        </div>

        <div class="card">
            <h2>Data sharing</h2>
            <ul>
                <li>We share your message with elected representatives you direct us to contact.</li>
                <li>We may use third-party email delivery (configured via environment variables) solely to send your messages.</li>
                <li>We do not sell data to advertisers or brokers.</li>
            </ul>
        </div>

        <div class="card">
            <h2>Your choices and rights</h2>
            <ul>
                <li>Request deletion: email <a href="mailto:nursesunderfire1@gmail.com">nursesunderfire1@gmail.com</a> to remove your contact details or testimony.</li>
                <li>Update info: send corrections to the same address and we will confirm changes.</li>
                <li>Opt out: unsubscribe from any email we send or contact us directly to stop follow-ups.</li>
            </ul>
        </div>

        <div class="card">
            <h2>Data security</h2>
            <p>Contact and testimony submissions are stored in a secure data file behind the backend service. If email delivery is enabled, outbound mail uses SMTP authentication. Access to stored submissions should be limited to designated administrators.</p>
        </div>

        <div class="card">
            <h2>Questions</h2>
            <p>For any privacy questions, reach us at <a href="mailto:nursesunderfire1@gmail.com">nursesunderfire1@gmail.com</a>.</p>
        </div>
    </main>
    <footer>
        <p>&copy; 2025 Nurses Under Fire. <a href="accessibility.html">Accessibility</a> | <a href="sitemap.html">Sitemap</a></p>
    </footer>
</body>
</html>
server.js
New
+122-0
const express = require('express');
const cors = require('cors');
const fs = require('fs');
const path = require('path');
const nodemailer = require('nodemailer');

const app = express();
const PORT = process.env.PORT || 3000;
const DATA_DIR = path.join(__dirname, 'data');
const SUBMISSIONS_PATH = path.join(DATA_DIR, 'submissions.json');
const GOAL = Number(process.env.ACTION_GOAL || 0);

app.use(cors());
app.use(express.json());
app.use(express.static(path.join(__dirname)));

function ensureDataFile() {
    if (!fs.existsSync(DATA_DIR)) {
        fs.mkdirSync(DATA_DIR);
    }
    if (!fs.existsSync(SUBMISSIONS_PATH)) {
        fs.writeFileSync(SUBMISSIONS_PATH, '[]', 'utf8');
    }
}

function readSubmissions() {
    ensureDataFile();
    try {
        const content = fs.readFileSync(SUBMISSIONS_PATH, 'utf8');
        return JSON.parse(content);
    } catch (error) {
        console.warn('Unable to read submissions file, resetting to empty array.', error.message);
        writeSubmissions([]);
        return [];
    }
}

function writeSubmissions(entries) {
    ensureDataFile();
    fs.writeFileSync(SUBMISSIONS_PATH, JSON.stringify(entries, null, 2), 'utf8');
}

async function sendNotification(payload) {
    const { SMTP_HOST, SMTP_PORT, SMTP_USER, SMTP_PASS, NOTIFY_TO } = process.env;
    if (!SMTP_HOST || !SMTP_PORT || !SMTP_USER || !SMTP_PASS || !NOTIFY_TO) {
        return; // Email delivery not configured
    }

    const transporter = nodemailer.createTransport({
        host: SMTP_HOST,
        port: Number(SMTP_PORT),
        secure: Number(SMTP_PORT) === 465,
        auth: {
            user: SMTP_USER,
            pass: SMTP_PASS
        }
    });

    const message = {
        from: SMTP_USER,
        to: NOTIFY_TO,
        subject: 'New Nurses Under Fire contact submission',
        text: `Name: ${payload.name}\nEmail: ${payload.email}\nPhone: ${payload.phone}\nZIP: ${payload.zip}\n\nMessage:\n${payload.message}`
    };

    await transporter.sendMail(message);
}

app.get('/api/metrics', (_req, res) => {
    const submissions = readSubmissions();
    const totalActions = submissions.length;
    res.json({
        contactSubmissions: totalActions,
        totalActions,
        goal: GOAL
    });
});

app.post('/api/contact', async (req, res) => {
    const { name = '', email = '', phone = '', zip = '', message = '' } = req.body || {};

    if (!name.trim() || !email.trim() || !message.trim()) {
        return res.status(400).json({ error: 'Name, email, and message are required.' });
    }

    if (zip && !/^\d{5}$/.test(String(zip).trim())) {
        return res.status(400).json({ error: 'ZIP code must be 5 digits.' });
    }

    if (message.length > 5000) {
        return res.status(400).json({ error: 'Message is too long. Please limit to 5,000 characters.' });
    }

    const submission = {
        name: name.trim(),
        email: email.trim(),
        phone: phone.trim(),
        zip: String(zip).trim(),
        message: message.trim(),
        submittedAt: new Date().toISOString()
    };

    const submissions = readSubmissions();
    submissions.push(submission);
    writeSubmissions(submissions);

    try {
        await sendNotification(submission);
    } catch (error) {
        console.warn('Email notification failed:', error.message);
    }

    res.status(201).json({ message: 'Submission recorded.', metrics: { contactSubmissions: submissions.length, totalActions: submissions.length, goal: GOAL } });
});

app.get('/health', (_req, res) => {
    res.json({ status: 'ok' });
});

app.listen(PORT, () => {
    console.log(`Backend listening on port ${PORT}`);
});
